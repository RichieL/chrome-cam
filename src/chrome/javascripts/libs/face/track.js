// Generated by CoffeeScript 1.4.0
(function() {

  define(['libs/face/ccv', 'libs/face/face'], function() {
    var backCanvas, backContext, pub, ready;
    backCanvas = document.createElement("canvas");
    backContext = backCanvas.getContext("2d");
    ready = true;
    return pub = {
      init: function() {
        backCanvas.width = 320;
        return backCanvas.height = 240;
      },
      track: function(video, callback) {
        var cb, options;
        if (!ready) {
          return;
        }
        ready = false;
        backContext.drawImage(video, 0, 0, backCanvas.width, backCanvas.height);
        options = {
          canvas: ccv.grayscale(ccv.pre(backCanvas)),
          cascade: cascade,
          interval: 5,
          min_neighbors: 1,
          async: true,
          worker: 1
        };
        cb = ccv.detect_objects(options);
        return cb(function(comp) {
          var track;
          track = {
            faces: comp,
            trackWidth: backCanvas.width
          };
          callback(track);
          return ready = true;
        });
      }
    };
  });

}).call(this);
