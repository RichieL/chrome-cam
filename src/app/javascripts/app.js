// Generated by CoffeeScript 1.3.3
(function() {

  define(['Kendo', 'Glfx', 'mylibs/camera/camera', 'mylibs/bar/bottom', 'mylibs/bar/top', 'mylibs/popover/popover', 'mylibs/full/full', 'mylibs/postman/postman', 'mylibs/utils/utils', 'mylibs/gallery/gallery', 'mylibs/gallery/details', 'mylibs/events/events', 'mylibs/file/filewrapper', 'mylibs/about/about', 'mylibs/confirm/confirm', 'mylibs/assets/assets', 'mylibs/effects/effects', "text!mylibs/nocamera/views/nocamera.html"], function(kendo, glfx, camera, bottom, top, popover, full, postman, utils, gallery, details, events, filewrapper, about, confirm, assets, effects, nocamera) {
    var pub;
    return pub = {
      init: function() {
        var APP;
        APP = window.APP = {};
        APP.full = full;
        APP.filters = effects.data;
        APP.gallery = gallery;
        APP.about = about;
        APP.confirm = confirm;
        events.init();
        postman.init(window.top);
        assets.init();
        $.subscribe('/camera/unsupported', function() {
          new kendo.View("#no-camera", nocamera).render(kendo.observable({}), true);
          return APP.app.navigate("#no-camera");
        });
        $.publish("/postman/deliver", [true, "/menu/enable"]);
        $.subscribe("/localization/response", function(dict) {
          var ready;
          APP.localization = dict;
          ready = function() {
            var effect, hideSplash, _i, _len, _ref;
            APP.bottom = bottom.init(".bottom");
            APP.top = top.init(".top");
            APP.popover = popover.init("#gallery");
            full.init("#capture");
            details.init("#details");
            gallery.init("#thumbnails");
            about.init("#about");
            confirm.init("#confirm");
            effects.init();
            _ref = effects.data;
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
              effect = _ref[_i];
              effect.name = APP.localization[effect.id];
            }
            full.show(effects.data[0]);
            $.publish("/postman/deliver", [
              {
                message: ""
              }, "/app/ready"
            ]);
            window.APP.app = new kendo.mobile.Application(document.body, {
              platform: "android"
            });
            hideSplash = function() {
              return $("#splash").kendoAnimate({
                effects: "fade:out",
                duration: 1000,
                hide: true
              });
            };
            setTimeout(hideSplash, 100);
            return $.subscribe("/keyboard/close", function() {
              return $.publish("/postman/deliver", [null, "/window/close"]);
            });
          };
          return camera.init("countdown", ready);
        });
        return $.publish("/postman/deliver", [null, "/localization/request"]);
      }
    };
  });

}).call(this);
